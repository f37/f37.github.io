<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>SeqMDN module &mdash; Data Orchestration Toolbox</title>
    
    <link rel="stylesheet" href="_static/classic.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="shortcut icon" href="_static/ncsqr.ico"/>
    <link rel="top" title="Data Orchestration Toolbox" href="index.html" /> 
  </head>
  <body role="document">
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">Data Orchestration Toolbox</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="seqmdn-module">
<h1>SeqMDN module<a class="headerlink" href="#seqmdn-module" title="Permalink to this headline">¶</a></h1>
<p>This software toolbox took the theoretical background from <strong>Mixture Density Networks</strong> by Christopher M. Bishop, 1994.
Given a sequence of data. The model approximates the underlying density of the provided sequence given the observation
of a fixed amount of previous timesteps. The model is invariant of the dimensionality or modality of the data. Given
the first coordinate represents the &#8216;time&#8217; or &#8216;order&#8217; of the sequence. A Mixture Density Network has universal
approximation capabilities, thus we are also independent of correlation of the different dimensions. When the
density function <span class="math">\(p(t|x)\)</span>, prior to past events is approximated, the model is capable of drawing
autoregressive random variables from the density function and thus generating a sequence with a similar features as the
provided sequence we fed data from.</p>
<hr class="docutils" />
<span class="target" id="module-SeqMDN"></span><dl class="class">
<dt id="SeqMDN.SeqMDN">
<em class="property">class </em><code class="descclassname">SeqMDN.</code><code class="descname">SeqMDN</code><span class="sig-paren">(</span><em>data</em><span class="sig-paren">)</span><a class="headerlink" href="#SeqMDN.SeqMDN" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">object</span></code></p>
<p>This class provides an object that is capable of when its feed with data, predict the next possible outcome for a
fixed sequence of input provided.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>data</strong> &#8211; original data the model is fittet  through</li>
<li><strong>c</strong> &#8211; dimensionality of the model, obtained be data input</li>
<li><strong>num_data</strong> &#8211; amount of data provided by the input</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>Tensorflow nodes:</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>x</strong> &#8211; input</li>
<li><strong>t</strong> &#8211; label</li>
<li><strong>α</strong> &#8211; weight of mixture</li>
<li><strong>σ</strong> &#8211; simga, std variation</li>
<li><strong>μ</strong> &#8211; mean</li>
<li><strong>Φ</strong> &#8211; probability function</li>
<li><strong>e</strong> &#8211; error messured for the model</li>
<li><strong>opt</strong> &#8211; optimizer</li>
</ul>
</td>
</tr>
</tbody>
</table>
<div class="admonition-todo admonition" id="index-0">
<p class="first admonition-title">Todo</p>
<p class="last">introduce variables global, maybe refer to hyperparameter global definition</p>
</div>
<dl class="docutils">
<dt>The N dimensional np.ndarray <strong>data</strong> will provide the learning platform. The first dimension is indicating time or</dt>
<dd>causality dimension of states. Furthermore <strong>data</strong> is assumed to be sorted in time/causality.</dd>
</dl>
<dl class="method">
<dt id="SeqMDN.SeqMDN._denormalize">
<code class="descname">_denormalize</code><span class="sig-paren">(</span><em>x</em><span class="sig-paren">)</span><a class="headerlink" href="#SeqMDN.SeqMDN._denormalize" title="Permalink to this definition">¶</a></dt>
<dd><p>Inverse operation for Normalize data pattern <strong>x</strong> : <a class="reference external" href="Neurocat.html">Neurocat</a> preprocessing method.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>x</strong> &#8211; data pattern to be denormalized.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">denormalized x</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="SeqMDN.SeqMDN._inference">
<code class="descname">_inference</code><span class="sig-paren">(</span><em>α</em>, <em>σ</em>, <em>μ</em>, <em>Φ</em><span class="sig-paren">)</span><a class="headerlink" href="#SeqMDN.SeqMDN._inference" title="Permalink to this definition">¶</a></dt>
<dd><p>Chooeses maximal value of alpha to get greedy density function with maximum probability to occur.</p>
<a class="reference internal image-reference" href="_images/inference.png"><img alt="...image missing..." class="align-center" src="_images/inference.png" style="height: 300px;" /></a>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>α</strong> &#8211; </li>
<li><strong>σ</strong> &#8211; </li>
<li><strong>μ</strong> &#8211; </li>
<li><strong>Φ</strong> &#8211; </li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><p>greedy mixture parameter:</p>
<ul class="simple">
<li><strong>_α</strong></li>
<li><strong>_σ</strong></li>
<li><strong>_μ</strong></li>
<li><strong>_Φ</strong></li>
<li><strong>_π</strong></li>
</ul>
</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="SeqMDN.SeqMDN._loss">
<code class="descname">_loss</code><span class="sig-paren">(</span><em>α</em>, <em>Φ</em><span class="sig-paren">)</span><a class="headerlink" href="#SeqMDN.SeqMDN._loss" title="Permalink to this definition">¶</a></dt>
<dd><div class="math">
\[p(t|x) = \sum_{i=1}^{m} α(x)Φ(t|x)\]</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>α</strong> &#8211; </li>
<li><strong>Φ</strong> &#8211; </li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><strong>p(t|x)</strong> representing the error/loss of the system in particular training pattern.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="SeqMDN.SeqMDN._mixture">
<code class="descname">_mixture</code><span class="sig-paren">(</span><em>z</em>, <em>t</em><span class="sig-paren">)</span><a class="headerlink" href="#SeqMDN.SeqMDN._mixture" title="Permalink to this definition">¶</a></dt>
<dd><p>Takes network outputs z and transforms them into
mixture components: α, σ, μ.</p>
<a class="reference internal image-reference" href="_images/mdn_short.png"><img alt="...image missing..." class="align-center" src="_images/mdn_short.png" style="height: 300px;" /></a>
<p>The gaussian distribution Φ according to α, σ, μ and the label t will
be calculated as output.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>z</strong> (<em>tf.array</em>) &#8211; shape=(?, (c + 2) * modi * futHor)</li>
<li><strong>t</strong> (<em>tf.array</em>) &#8211; shape=(?, 1, c)</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><p>tuple of tf.array, namely (<strong>α</strong>, <strong>σ</strong>, <strong>Φ</strong>, <strong>μ</strong>)</p>
<p>α, σ, Φ with shape=(?, modal, 1) and μ with shape=(?, modal, c)</p>
</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="SeqMDN.SeqMDN._normalize">
<code class="descname">_normalize</code><span class="sig-paren">(</span><em>x</em><span class="sig-paren">)</span><a class="headerlink" href="#SeqMDN.SeqMDN._normalize" title="Permalink to this definition">¶</a></dt>
<dd><p>Normalize data pattern <strong>x</strong> : <a class="reference external" href="Neurocat.html">Neurocat</a> preprocessing method.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>x</strong> &#8211; data pattern to be normalized.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">normalized x</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="SeqMDN.SeqMDN._optimizer">
<code class="descname">_optimizer</code><span class="sig-paren">(</span><em>e</em><span class="sig-paren">)</span><a class="headerlink" href="#SeqMDN.SeqMDN._optimizer" title="Permalink to this definition">¶</a></dt>
<dd><p>Optimizer for SeqMDN. Minimizes the error <strong>e</strong> by propagating gradient through computation graph.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>e</strong> &#8211; error/loss</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">operational node <strong>opt</strong></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="SeqMDN.SeqMDN._timeembedding">
<code class="descname">_timeembedding</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#SeqMDN.SeqMDN._timeembedding" title="Permalink to this definition">¶</a></dt>
<dd><p>time embedding of provided data.</p>
<a class="reference internal image-reference" href="_images/timeembedding.png"><img alt="...image missing..." class="align-center" src="_images/timeembedding.png" style="height: 300px;" /></a>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">tuple of np.ndarray, namely x_data and t_data embedded in time</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="SeqMDN.SeqMDN.fit">
<code class="descname">fit</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#SeqMDN.SeqMDN.fit" title="Permalink to this definition">¶</a></dt>
<dd><p>Fit mixture model for approximating the following density, for</p>
<p>x ~ data
p(x[t] | x[t-1], x[t-2], ..., x[t-pasHor])</p>
<p>Train Neural Network with Mixture Density Components.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">None</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="SeqMDN.SeqMDN.graph">
<code class="descname">graph</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#SeqMDN.SeqMDN.graph" title="Permalink to this definition">¶</a></dt>
<dd><p>Build tensorflow computation graph for SeqMDN</p>
<div class="admonition-todo admonition" id="index-1">
<p class="first admonition-title">Todo</p>
<p class="last">picture of graph</p>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">Minimal model nodes to describe SeqMDN:<ul class="simple">
<li><strong>x</strong> input node (tf.placeholder)</li>
<li><strong>t</strong> label node (tf.placeholder)</li>
<li><strong>α</strong> calculation of α</li>
<li><strong>σ</strong> calculation of σ</li>
<li><strong>μ</strong> calculation of μ</li>
<li><strong>Φ</strong> calculation of Φ</li>
</ul>
<p>Inference:</p>
<ul class="simple">
<li><strong>_α</strong></li>
<li><strong>_σ</strong></li>
<li><strong>_μ</strong></li>
<li><strong>_Φ</strong></li>
<li><strong>_π</strong></li>
</ul>
<p>Optimization:</p>
<ul class="simple">
<li><strong>e</strong></li>
<li><strong>opt</strong></li>
</ul>
<p>Saving:</p>
<ul class="simple">
<li><strong>save_op</strong></li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="SeqMDN.SeqMDN.predict">
<code class="descname">predict</code><span class="sig-paren">(</span><em>x=None</em>, <em>s=500</em><span class="sig-paren">)</span><a class="headerlink" href="#SeqMDN.SeqMDN.predict" title="Permalink to this definition">¶</a></dt>
<dd><p>Predict <strong>s</strong> future states with <strong>x</strong> as initial state.</p>
<p>SeqMDN has a model of its environment
<span class="math">\(P\)</span>. When confronted with a state
<span class="math">\(x \in \mathbb{R}^{(m, m_{1}, \dots, m_{d-1})}\)</span> with horizont
<span class="math">\(m \in \mathbb{N}\)</span> SeqMDN occopies an approximation of the density approximation for the next state
<span class="math">\(y \in \mathbb{R}^{(n, m_{1}, \dots, m_{d-1})}\)</span> with <span class="math">\(n \in \mathbb{N}\)</span> <span class="math">\(m &gt; n\)</span>.
The order of the first (zeroth) dimension can be referred to as time or causality.</p>
<div class="admonition-todo admonition" id="index-2">
<p class="first admonition-title">Todo</p>
<p class="last">correct mistake in operation. Time is too big when we concatenate</p>
</div>
<div class="admonition-todo admonition" id="index-3">
<p class="first admonition-title">Todo</p>
<p class="last">check out if we can build a thing that is capable of reading that form or an other more flexible version</p>
</div>
<p>We recursively define the input for the model <span class="math">\(\mathcal{X}\)</span> as an auto regressive agent.</p>
<div class="math">
\[\mathcal{X}_{1} := x\]</div>
<p>The model calculates recursively with  <span class="math">\(t_{i}\)</span> ranomly sampled according to
<span class="math">\(t_{i} \sim p(t | x_{i})\)</span></p>
<div class="math">
\[\mathcal{X}_{i+1} := t_{i}\]</div>
<p>To calculate the output of the model we define.
For x and y, defined above, we define  <span class="math">\(\circledast\)</span> as</p>
<div class="math">
\[x \circledast y := (x(1, *), \dots, x(m, *), y(1, *), \dots, y(n, *)) \in \mathbb{R}^{(m+n, m_{1}, \dots, m_{d-1})}\]</div>
<div class="math">
\[\mathcal{O} := \mathcal{X}_{1} \circledast \dots \circledast \mathcal{X}_{s}\]</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>x</strong> &#8211; Past input, prior for the system.</li>
<li><strong>s</strong> &#8211; amount of samples to be auto regressively generated.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">inference, params, probs, explain what it means, maybe sample output</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="index.html">
              <img class="logo" src="_static/hu.png" alt="Logo"/>
            </a></p>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">Data Orchestration Toolbox</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &copy; Copyright 2018, Florens Greßner.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.3.6.
    </div>
  </body>
</html>